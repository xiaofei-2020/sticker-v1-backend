(this["webpackJsonp"]=this["webpackJsonp"]||[]).push([["GenGif"],{"04d1":function(t,e,r){var n=r("342f"),i=n.match(/firefox\/(\d+)/i);t.exports=!!i&&+i[1]},"0b25":function(t,e,r){var n=r("a691"),i=r("50c4");t.exports=function(t){if(void 0===t)return 0;var e=n(t),r=i(e);if(e!==r)throw RangeError("Wrong length or index");return r}},1148:function(t,e,r){"use strict";var n=r("a691"),i=r("577e"),a=r("1d80");t.exports=function(t){var e=i(a(this)),r="",o=n(t);if(o<0||o==1/0)throw RangeError("Wrong number of repetitions");for(;o>0;(o>>>=1)&&(e+=e))1&o&&(r+=e);return r}},1448:function(t,e,r){var n=r("dfb9"),i=r("b6b7");t.exports=function(t,e){return n(i(t),e)}},"145e":function(t,e,r){"use strict";var n=r("7b0b"),i=r("23cb"),a=r("50c4"),o=Math.min;t.exports=[].copyWithin||function(t,e){var r=n(this),s=a(r.length),u=i(t,s),c=i(e,s),f=arguments.length>2?arguments[2]:void 0,l=o((void 0===f?s:i(f,s))-c,s-u),h=1;c<u&&u<c+l&&(h=-1,c+=l-1,u+=l-1);while(l-- >0)c in r?r[u]=r[c]:delete r[u],u+=h,c+=h;return r}},"159b":function(t,e,r){var n=r("da84"),i=r("fdbc"),a=r("17c2"),o=r("9112");for(var s in i){var u=n[s],c=u&&u.prototype;if(c&&c.forEach!==a)try{o(c,"forEach",a)}catch(f){c.forEach=a}}},"170b":function(t,e,r){"use strict";var n=r("ebb5"),i=r("50c4"),a=r("23cb"),o=r("b6b7"),s=n.aTypedArray,u=n.exportTypedArrayMethod;u("subarray",(function(t,e){var r=s(this),n=r.length,u=a(t,n),c=o(r);return new c(r.buffer,r.byteOffset+u*r.BYTES_PER_ELEMENT,i((void 0===e?n:a(e,n))-u))}))},"17c2":function(t,e,r){"use strict";var n=r("b727").forEach,i=r("a640"),a=i("forEach");t.exports=a?[].forEach:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}},"182d":function(t,e,r){var n=r("f8cd");t.exports=function(t,e){var r=n(t);if(r%e)throw RangeError("Wrong offset");return r}},"219c":function(t,e,r){"use strict";var n=r("ebb5"),i=r("da84"),a=r("d039"),o=r("1c0b"),s=r("50c4"),u=r("addb"),c=r("04d1"),f=r("d998"),l=r("2d00"),h=r("512ce"),d=n.aTypedArray,p=n.exportTypedArrayMethod,g=i.Uint16Array,v=g&&g.prototype.sort,m=!!v&&!a((function(){var t=new g(2);t.sort(null),t.sort({})})),y=!!v&&!a((function(){if(l)return l<74;if(c)return c<67;if(f)return!0;if(h)return h<602;var t,e,r=new g(516),n=Array(516);for(t=0;t<516;t++)e=t%4,r[t]=515-t,n[t]=t-2*e+3;for(r.sort((function(t,e){return(t/4|0)-(e/4|0)})),t=0;t<516;t++)if(r[t]!==n[t])return!0})),b=function(t){return function(e,r){return void 0!==t?+t(e,r)||0:r!==r?-1:e!==e?1:0===e&&0===r?1/e>0&&1/r<0?1:-1:e>r}};p("sort",(function(t){var e=this;if(void 0!==t&&o(t),y)return v.call(e,t);d(e);var r,n=s(e.length),i=Array(n);for(r=0;r<n;r++)i[r]=e[r];for(i=u(e,b(t)),r=0;r<n;r++)e[r]=i[r];return e}),!y||m)},"25a1":function(t,e,r){"use strict";var n=r("ebb5"),i=r("d58f").right,a=n.aTypedArray,o=n.exportTypedArrayMethod;o("reduceRight",(function(t){return i(a(this),t,arguments.length,arguments.length>1?arguments[1]:void 0)}))},2954:function(t,e,r){"use strict";var n=r("ebb5"),i=r("b6b7"),a=r("d039"),o=n.aTypedArray,s=n.exportTypedArrayMethod,u=[].slice,c=a((function(){new Int8Array(1).slice()}));s("slice",(function(t,e){var r=u.call(o(this),t,e),n=i(this),a=0,s=r.length,c=new n(s);while(s>a)c[a]=r[a++];return c}),c)},"2cfc":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var n=r("e962"),i=r("584f"),a={blocks:function(t){for(var e=0,r=[],n=t.data.length,a=0,o=(0,i.readByte)()(t);o!==e;o=(0,i.readByte)()(t)){if(t.pos+o>=n){var s=n-t.pos;r.push((0,i.readBytes)(s)(t)),a+=s;break}r.push((0,i.readBytes)(o)(t)),a+=o}for(var u=new Uint8Array(a),c=0,f=0;f<r.length;f++)u.set(r[f],c),c+=r[f].length;return u}},o=(0,n.conditional)({gce:[{codes:(0,i.readBytes)(2)},{byteSize:(0,i.readByte)()},{extras:(0,i.readBits)({future:{index:0,length:3},disposal:{index:3,length:3},userInput:{index:6},transparentColorGiven:{index:7}})},{delay:(0,i.readUnsigned)(!0)},{transparentColorIndex:(0,i.readByte)()},{terminator:(0,i.readByte)()}]},(function(t){var e=(0,i.peekBytes)(2)(t);return 33===e[0]&&249===e[1]})),s=(0,n.conditional)({image:[{code:(0,i.readByte)()},{descriptor:[{left:(0,i.readUnsigned)(!0)},{top:(0,i.readUnsigned)(!0)},{width:(0,i.readUnsigned)(!0)},{height:(0,i.readUnsigned)(!0)},{lct:(0,i.readBits)({exists:{index:0},interlaced:{index:1},sort:{index:2},future:{index:3,length:2},size:{index:5,length:3}})}]},(0,n.conditional)({lct:(0,i.readArray)(3,(function(t,e,r){return Math.pow(2,r.descriptor.lct.size+1)}))},(function(t,e,r){return r.descriptor.lct.exists})),{data:[{minCodeSize:(0,i.readByte)()},a]}]},(function(t){return 44===(0,i.peekByte)()(t)})),u=(0,n.conditional)({text:[{codes:(0,i.readBytes)(2)},{blockSize:(0,i.readByte)()},{preData:function(t,e,r){return(0,i.readBytes)(r.text.blockSize)(t)}},a]},(function(t){var e=(0,i.peekBytes)(2)(t);return 33===e[0]&&1===e[1]})),c=(0,n.conditional)({application:[{codes:(0,i.readBytes)(2)},{blockSize:(0,i.readByte)()},{id:function(t,e,r){return(0,i.readString)(r.blockSize)(t)}},a]},(function(t){var e=(0,i.peekBytes)(2)(t);return 33===e[0]&&255===e[1]})),f=(0,n.conditional)({comment:[{codes:(0,i.readBytes)(2)},a]},(function(t){var e=(0,i.peekBytes)(2)(t);return 33===e[0]&&254===e[1]})),l=[{header:[{signature:(0,i.readString)(3)},{version:(0,i.readString)(3)}]},{lsd:[{width:(0,i.readUnsigned)(!0)},{height:(0,i.readUnsigned)(!0)},{gct:(0,i.readBits)({exists:{index:0},resolution:{index:1,length:3},sort:{index:4},size:{index:5,length:3}})},{backgroundColorIndex:(0,i.readByte)()},{pixelAspectRatio:(0,i.readByte)()}]},(0,n.conditional)({gct:(0,i.readArray)(3,(function(t,e){return Math.pow(2,e.lsd.gct.size+1)}))},(function(t,e){return e.lsd.gct.exists})),{frames:(0,n.loop)([o,c,f,s,u],(function(t){var e=(0,i.peekByte)()(t);return 33===e||44===e}))}],h=l;e["default"]=h},"2d7f":function(t,e,r){},3280:function(t,e,r){"use strict";var n=r("ebb5"),i=r("e58c"),a=n.aTypedArray,o=n.exportTypedArrayMethod;o("lastIndexOf",(function(t){return i.apply(a(this),arguments)}))},"38cf":function(t,e,r){var n=r("23e7"),i=r("1148");n({target:"String",proto:!0},{repeat:i})},"3a7b":function(t,e,r){"use strict";var n=r("ebb5"),i=r("b727").findIndex,a=n.aTypedArray,o=n.exportTypedArrayMethod;o("findIndex",(function(t){return i(a(this),t,arguments.length>1?arguments[1]:void 0)}))},"3c35":function(t,e){(function(e){t.exports=e}).call(this,{})},"3c5d":function(t,e,r){"use strict";var n=r("ebb5"),i=r("50c4"),a=r("182d"),o=r("7b0b"),s=r("d039"),u=n.aTypedArray,c=n.exportTypedArrayMethod,f=s((function(){new Int8Array(1).set({})}));c("set",(function(t){u(this);var e=a(arguments.length>1?arguments[1]:void 0,1),r=this.length,n=o(t),s=i(n.length),c=0;if(s+e>r)throw RangeError("Wrong length");while(c<s)this[e+c]=n[c++]}),f)},"3fcc":function(t,e,r){"use strict";var n=r("ebb5"),i=r("b727").map,a=r("b6b7"),o=n.aTypedArray,s=n.exportTypedArrayMethod;s("map",(function(t){return i(o(this),t,arguments.length>1?arguments[1]:void 0,(function(t,e){return new(a(t))(e)}))}))},"466d":function(t,e,r){"use strict";var n=r("d784"),i=r("825a"),a=r("50c4"),o=r("577e"),s=r("1d80"),u=r("8aa5"),c=r("14c3");n("match",(function(t,e,r){return[function(e){var r=s(this),n=void 0==e?void 0:e[t];return void 0!==n?n.call(e,r):new RegExp(e)[t](o(r))},function(t){var n=i(this),s=o(t),f=r(e,n,s);if(f.done)return f.value;if(!n.global)return c(n,s);var l=n.unicode;n.lastIndex=0;var h,d=[],p=0;while(null!==(h=c(n,s))){var g=o(h[0]);d[p]=g,""===g&&(n.lastIndex=u(s,a(n.lastIndex),l)),p++}return 0===p?null:d}]}))},"512ce":function(t,e,r){var n=r("342f"),i=n.match(/AppleWebKit\/(\d+)\./);t.exports=!!i&&+i[1]},"53ca":function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));r("a4d3"),r("e01a"),r("d3b7"),r("d28b"),r("3ca3"),r("ddb0");function n(t){return n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}},"584f":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.readBits=e.readArray=e.readUnsigned=e.readString=e.peekBytes=e.readBytes=e.peekByte=e.readByte=e.buildStream=void 0;var n=function(t){return{data:t,pos:0}};e.buildStream=n;var i=function(){return function(t){return t.data[t.pos++]}};e.readByte=i;var a=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return function(e){return e.data[e.pos+t]}};e.peekByte=a;var o=function(t){return function(e){return e.data.subarray(e.pos,e.pos+=t)}};e.readBytes=o;var s=function(t){return function(e){return e.data.subarray(e.pos,e.pos+t)}};e.peekBytes=s;var u=function(t){return function(e){return Array.from(o(t)(e)).map((function(t){return String.fromCharCode(t)})).join("")}};e.readString=u;var c=function(t){return function(e){var r=o(2)(e);return t?(r[1]<<8)+r[0]:(r[0]<<8)+r[1]}};e.readUnsigned=c;var f=function(t,e){return function(r,n,i){for(var a="function"===typeof e?e(r,n,i):e,s=o(t),u=new Array(a),c=0;c<a;c++)u[c]=s(r);return u}};e.readArray=f;var l=function(t,e,r){for(var n=0,i=0;i<r;i++)n+=t[e+i]&&Math.pow(2,r-i-1);return n},h=function(t){return function(e){for(var r=i()(e),n=new Array(8),a=0;a<8;a++)n[7-a]=!!(r&1<<a);return Object.keys(t).reduce((function(e,r){var i=t[r];return i.length?e[r]=l(n,i.index,i.length):e[r]=n[i.index],e}),{})}};e.readBits=h},"5cc6":function(t,e,r){var n=r("74e8");n("Uint8",(function(t){return function(e,r,n){return t(this,e,r,n)}}))},"5e89":function(t,e,r){var n=r("861d"),i=Math.floor;t.exports=function(t){return!n(t)&&isFinite(t)&&i(t)===t}},"5f96":function(t,e,r){"use strict";var n=r("ebb5"),i=n.aTypedArray,a=n.exportTypedArrayMethod,o=[].join;a("join",(function(t){return o.apply(i(this),arguments)}))},"60bd":function(t,e,r){"use strict";var n=r("da84"),i=r("ebb5"),a=r("e260"),o=r("b622"),s=o("iterator"),u=n.Uint8Array,c=a.values,f=a.keys,l=a.entries,h=i.aTypedArray,d=i.exportTypedArrayMethod,p=u&&u.prototype[s],g=!!p&&("values"==p.name||void 0==p.name),v=function(){return c.call(h(this))};d("entries",(function(){return l.call(h(this))})),d("keys",(function(){return f.call(h(this))})),d("values",v,!g),d(s,v,!g)},"621a":function(t,e,r){"use strict";var n=r("da84"),i=r("83ab"),a=r("a981"),o=r("9112"),s=r("e2cc"),u=r("d039"),c=r("19aa"),f=r("a691"),l=r("50c4"),h=r("0b25"),d=r("77a7"),p=r("e163"),g=r("d2bb"),v=r("241c").f,m=r("9bf2").f,y=r("81d5"),b=r("d44e"),w=r("69f3"),x=w.get,A=w.set,M="ArrayBuffer",T="DataView",_="prototype",k="Wrong length",B="Wrong index",L=n[M],S=L,P=n[T],C=P&&P[_],F=Object.prototype,I=n.RangeError,E=d.pack,R=d.unpack,D=function(t){return[255&t]},O=function(t){return[255&t,t>>8&255]},U=function(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]},j=function(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]},W=function(t){return E(t,23,4)},z=function(t){return E(t,52,8)},N=function(t,e){m(t[_],e,{get:function(){return x(this)[e]}})},G=function(t,e,r,n){var i=h(r),a=x(t);if(i+e>a.byteLength)throw I(B);var o=x(a.buffer).bytes,s=i+a.byteOffset,u=o.slice(s,s+e);return n?u:u.reverse()},Y=function(t,e,r,n,i,a){var o=h(r),s=x(t);if(o+e>s.byteLength)throw I(B);for(var u=x(s.buffer).bytes,c=o+s.byteOffset,f=n(+i),l=0;l<e;l++)u[c+l]=f[a?l:e-l-1]};if(a){if(!u((function(){L(1)}))||!u((function(){new L(-1)}))||u((function(){return new L,new L(1.5),new L(NaN),L.name!=M}))){S=function(t){return c(this,S),new L(h(t))};for(var $,V=S[_]=L[_],Q=v(L),q=0;Q.length>q;)($=Q[q++])in S||o(S,$,L[$]);V.constructor=S}g&&p(C)!==F&&g(C,F);var J=new P(new S(2)),H=C.setInt8;J.setInt8(0,2147483648),J.setInt8(1,2147483649),!J.getInt8(0)&&J.getInt8(1)||s(C,{setInt8:function(t,e){H.call(this,t,e<<24>>24)},setUint8:function(t,e){H.call(this,t,e<<24>>24)}},{unsafe:!0})}else S=function(t){c(this,S,M);var e=h(t);A(this,{bytes:y.call(new Array(e),0),byteLength:e}),i||(this.byteLength=e)},P=function(t,e,r){c(this,P,T),c(t,S,T);var n=x(t).byteLength,a=f(e);if(a<0||a>n)throw I("Wrong offset");if(r=void 0===r?n-a:l(r),a+r>n)throw I(k);A(this,{buffer:t,byteLength:r,byteOffset:a}),i||(this.buffer=t,this.byteLength=r,this.byteOffset=a)},i&&(N(S,"byteLength"),N(P,"buffer"),N(P,"byteLength"),N(P,"byteOffset")),s(P[_],{getInt8:function(t){return G(this,1,t)[0]<<24>>24},getUint8:function(t){return G(this,1,t)[0]},getInt16:function(t){var e=G(this,2,t,arguments.length>1?arguments[1]:void 0);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=G(this,2,t,arguments.length>1?arguments[1]:void 0);return e[1]<<8|e[0]},getInt32:function(t){return j(G(this,4,t,arguments.length>1?arguments[1]:void 0))},getUint32:function(t){return j(G(this,4,t,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(t){return R(G(this,4,t,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(t){return R(G(this,8,t,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(t,e){Y(this,1,t,D,e)},setUint8:function(t,e){Y(this,1,t,D,e)},setInt16:function(t,e){Y(this,2,t,O,e,arguments.length>2?arguments[2]:void 0)},setUint16:function(t,e){Y(this,2,t,O,e,arguments.length>2?arguments[2]:void 0)},setInt32:function(t,e){Y(this,4,t,U,e,arguments.length>2?arguments[2]:void 0)},setUint32:function(t,e){Y(this,4,t,U,e,arguments.length>2?arguments[2]:void 0)},setFloat32:function(t,e){Y(this,4,t,W,e,arguments.length>2?arguments[2]:void 0)},setFloat64:function(t,e){Y(this,8,t,z,e,arguments.length>2?arguments[2]:void 0)}});b(S,M),b(P,T),t.exports={ArrayBuffer:S,DataView:P}},"649e":function(t,e,r){"use strict";var n=r("ebb5"),i=r("b727").some,a=n.aTypedArray,o=n.exportTypedArrayMethod;o("some",(function(t){return i(a(this),t,arguments.length>1?arguments[1]:void 0)}))},6685:function(t,e,r){"use strict";(function(t){var n=r("1da1"),i=(r("96cf"),r("d3b7"),r("3ca3"),r("ddb0"),r("2b3d"),r("ac1f"),r("1276"),r("159b"),r("a434"),r("7db0"),r("a365")),a=r("cf45"),o=r("365c"),s=r("9c0cf");e["a"]={name:"GenGif",data:function(){return{gif:"",mode:"default",gifMap:{default:{url:"",metaData:{blackRect:!0,textList:[{key:1,start:2,end:10,x:10,y:200,color:"#fff",fontSize:16,strokeWidth:.5,value:""}]},frameList:[],currentFramePreview:"",currentFrameIndex:0},custom:{url:"",metaData:{blackRect:!0,textList:[{key:1,start:2,end:10,x:10,y:200,color:"#fff",fontSize:16,strokeWidth:.5,value:""}]},frameList:[],currentFramePreview:"",currentFrameIndex:0}},defaultGif:"",defaultmetaData:{},customGif:"",metaData:{blackRect:!0,textList:[{key:1,start:2,end:10,x:10,y:200,color:"#fff",fontSize:16,strokeWidth:.5,value:""}]},currentFramePreview:"",currentFrameIndex:0,frameList:[],timer:null,loading:!1,tempmetaData:{},tempFrameList:[]}},methods:{formatNumber:function(t,e,r){return t=parseInt(t),isNaN(t)&&(t=e),t<e?t=e:t>r&&(t=r),t},downloadDefaultImg:function(e){return Object(n["a"])(regeneratorRuntime.mark((function r(){var n,i,a,s,u;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,Object(o["c"])({},{src:e});case 2:n=r.sent,i=t.from(n.data.data,"binary"),a=new Blob([i]),s=document.createElement("a"),u=window.URL.createObjectURL(a),s.href=u,s.download=e.split("/").pop(),s.click();case 10:case"end":return r.stop()}}),r)})))()},getGifFrames:function(t){return t.arrayBuffer().then((function(t){return Object(i["parseGIF"])(t)})).then((function(t){return Object(i["decompressFrames"])(t,!0)}))},getDefaultGif:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(o["d"])(t.$route.params.resource_id);case 2:if(r=e.sent,!r.data.success){e.next=12;break}return t.gifMap[t.mode].url=r.data.data.img,t.gifMap[t.mode].metaData=JSON.parse(r.data.data.content),e.next=8,t.urlToBlob(r.data.data.img);case 8:t.gifMap[t.mode].frameList=e.sent,t.gifMap[t.mode].frameList.forEach((function(e,r){e.id=r,e.preview=t.fullFrameToDateURL(r)})),t.gifMap[t.mode].currentFramePreview=t.gifMap[t.mode].frameList[0].preview,t.gifMap[t.mode].currentFrameIndex=0;case 12:case"end":return e.stop()}}),e)})))()},urlToBlob:function(e){var r=this;return Object(n["a"])(regeneratorRuntime.mark((function n(){var i,a,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,Object(o["c"])({},{src:e});case 2:if(i=n.sent,a=t.from(i.data.data,"binary"),s=new Blob([a]),!i.data.success){n.next=9;break}return n.abrupt("return",r.getGifFrames(s));case 9:r.$message({message:"获取数据失败，请稍后重试！",type:"error"});case 10:case"end":return n.stop()}}),n)})))()},handleUploadChange:function(t){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if("image/gif"===t.raw.type){r.next=4;break}return e.$message.warning("请选择 gif 格式的图片！"),e.$refs.upload.clearFiles(),r.abrupt("return");case 4:return e.mode="custom",e.gif="",r.next=8,Object(a["a"])(t.raw);case 8:return e.gifMap[e.mode].url=r.sent,r.next=11,e.getGifFrames(t.raw);case 11:e.gifMap[e.mode].frameList=r.sent,e.gifMap[e.mode].frameList.forEach((function(t,r){t.id=r,t.preview=e.fullFrameToDateURL(r)})),e.gifMap[e.mode].currentFramePreview=e.gifMap[e.mode].frameList[0].preview,e.gifMap[e.mode].currentFrameIndex=0,e.$refs.upload.clearFiles();case 16:case"end":return r.stop()}}),r)})))()},cancelSelect:function(){this.gif="",this.gifMap[this.mode].url="",this.gifMap[this.mode].currentFramePreview="",this.gifMap[this.mode].currentFrameIndex=0,this.gifMap[this.mode].frameList=[],this.mode="default"},fullFrameToDateURL:function(t){var e=document.createElement("canvas");e.width=this.gifMap[this.mode].frameList[0].dims.width,e.height=this.gifMap[this.mode].frameList[0].dims.height;var r=e.getContext("2d");return this.drawFullFrame(r,t),e.toDataURL()},drawPatch:function(t,e){var r=e.dims;if(1===e.disposalType){var n=document.createElement("canvas");n.width=this.gifMap[this.mode].frameList[0].dims.width,n.height=this.gifMap[this.mode].frameList[0].dims.height;var i=n.getContext("2d");i.putImageData(new ImageData(e.patch,r.width,r.height),e.dims.left,e.dims.top),t.drawImage(n,0,0)}else t.clearRect(0,0,this.gifMap[this.mode].frameList[0].dims.width,this.gifMap[this.mode].frameList[0].dims.height),t.putImageData(new ImageData(e.patch,r.width,r.height),e.dims.left,e.dims.top)},drawFullFrame:function(t,e){var r=document.createElement("canvas");r.width=this.gifMap[this.mode].frameList[0].dims.width,r.height=this.gifMap[this.mode].frameList[0].dims.height;for(var n=r.getContext("2d"),i=0;i<=e;i++)this.drawPatch(n,this.gifMap[this.mode].frameList[i]);t.drawImage(r,0,0)},changeFrame:function(t){var e;this.gifMap[this.mode].currentFramePreview=(null===(e=this.gifMap[this.mode].frameList[t])||void 0===e?void 0:e.preview)||""},handleAddText:function(){if(this.gifMap[this.mode].metaData.textList[0]){var t=JSON.parse(JSON.stringify(this.gifMap[this.mode].metaData.textList[0]));Object.assign(t,{key:(new Date).getTime(),value:""}),this.gifMap[this.mode].metaData.textList.push(t)}else{var e={key:(new Date).getTime(),start:1,end:2,x:void 0,y:void 0,color:"#fff",fontSize:18,strokeWidth:.5,value:""};this.gifMap[this.mode].metaData.textList.push(e)}},handleDeleteText:function(t){this.gifMap[this.mode].metaData.textList.splice(t,1)},handleChangeTextItem:function(t,e){this.gifMap[this.mode].metaData.textList.forEach((function(r){r[t]=e}))},blobToBase64:function(t){return new Promise((function(e,r){var n=new FileReader;n.onload=function(t){e(t.target.result)},n.readAsDataURL(t),n.onerror=function(){r(new Error("blobToBase64 error"))}}))},generateGif:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var r,i,a,o,u,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:console.log("开始生成"),t.loading=!0,r=(new Date).getTime(),i=t.gifMap[t.mode].frameList[0].dims.width,a=t.gifMap[t.mode].frameList[0].dims.height,o=new s["a"]({workers:6,quality:10}),u=regeneratorRuntime.mark((function e(r){var n,s,u,c,f,l,h;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.gifMap[t.mode].frameList[r],s=document.createElement("canvas"),s.width=i,s.height=a,u=s.getContext("2d"),c=function(t){return new Promise((function(e,r){var n=new Image;n.onload=function(){e(n)},n.onerror=function(){r(new Error("loadImg error"))},n.src=t}))},e.next=8,c(n.preview);case 8:f=e.sent,u.drawImage(f,0,0),t.gifMap[t.mode].metaData.blackRect&&u.fillRect(0,a-(t.gifMap[t.mode].metaData.textList[0].fontSize+10),i,t.gifMap[t.mode].metaData.textList[0].fontSize+10),l=t.gifMap[t.mode].metaData.textList.find((function(t){return+t.start<=r&&r<=+t.end})),l&&(u.font="bold ".concat(l.fontSize,"px sans-serif"),h=i,u.textAlign="center",u.fillStyle=l.color,u.fillText(l.value,h/2,a-8,h),l.strokeWidth>0&&(u.lineWidth=l.strokeWidth,u.strokeStyle="#000",u.strokeText(l.value,h/2,a-8,h))),o.addFrame(s,{copy:!0,delay:n.delay});case 14:case"end":return e.stop()}}),e)})),e.t0=regeneratorRuntime.keys(t.gifMap[t.mode].frameList);case 8:if((e.t1=e.t0()).done){e.next=13;break}return c=e.t1.value,e.delegateYield(u(c),"t2",11);case 11:e.next=8;break;case 13:o.on("finished",function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(n){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.blobToBase64(n);case 2:t.gif=e.sent,i=(new Date).getTime(),console.log("合成完毕，耗时=".concat(i-r,"毫秒")),t.loading=!1;case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),o.render();case 15:case"end":return e.stop()}}),e)})))()},download:function(t,e){var r=document.createElement("a");r.href=t,r.download=e,r.click()}},created:function(){this.getDefaultGif()}}}).call(this,r("b639").Buffer)},7156:function(t,e,r){var n=r("861d"),i=r("d2bb");t.exports=function(t,e,r){var a,o;return i&&"function"==typeof(a=e.constructor)&&a!==r&&n(o=a.prototype)&&o!==r.prototype&&i(t,o),t}},"72f7":function(t,e,r){"use strict";var n=r("ebb5").exportTypedArrayMethod,i=r("d039"),a=r("da84"),o=a.Uint8Array,s=o&&o.prototype||{},u=[].toString,c=[].join;i((function(){u.call({})}))&&(u=function(){return c.call(this)});var f=s.toString!=u;n("toString",u,f)},"735e":function(t,e,r){"use strict";var n=r("ebb5"),i=r("81d5"),a=n.aTypedArray,o=n.exportTypedArrayMethod;o("fill",(function(t){return i.apply(a(this),arguments)}))},"74e8":function(t,e,r){"use strict";var n=r("23e7"),i=r("da84"),a=r("83ab"),o=r("8aa7"),s=r("ebb5"),u=r("621a"),c=r("19aa"),f=r("5c6c"),l=r("9112"),h=r("5e89"),d=r("50c4"),p=r("0b25"),g=r("182d"),v=r("a04b"),m=r("5135"),y=r("f5df"),b=r("861d"),w=r("d9b5"),x=r("7c73"),A=r("d2bb"),M=r("241c").f,T=r("a078"),_=r("b727").forEach,k=r("2626"),B=r("9bf2"),L=r("06cf"),S=r("69f3"),P=r("7156"),C=S.get,F=S.set,I=B.f,E=L.f,R=Math.round,D=i.RangeError,O=u.ArrayBuffer,U=u.DataView,j=s.NATIVE_ARRAY_BUFFER_VIEWS,W=s.TYPED_ARRAY_CONSTRUCTOR,z=s.TYPED_ARRAY_TAG,N=s.TypedArray,G=s.TypedArrayPrototype,Y=s.aTypedArrayConstructor,$=s.isTypedArray,V="BYTES_PER_ELEMENT",Q="Wrong length",q=function(t,e){var r=0,n=e.length,i=new(Y(t))(n);while(n>r)i[r]=e[r++];return i},J=function(t,e){I(t,e,{get:function(){return C(this)[e]}})},H=function(t){var e;return t instanceof O||"ArrayBuffer"==(e=y(t))||"SharedArrayBuffer"==e},K=function(t,e){return $(t)&&!w(e)&&e in t&&h(+e)&&e>=0},Z=function(t,e){return e=v(e),K(t,e)?f(2,t[e]):E(t,e)},X=function(t,e,r){return e=v(e),!(K(t,e)&&b(r)&&m(r,"value"))||m(r,"get")||m(r,"set")||r.configurable||m(r,"writable")&&!r.writable||m(r,"enumerable")&&!r.enumerable?I(t,e,r):(t[e]=r.value,t)};a?(j||(L.f=Z,B.f=X,J(G,"buffer"),J(G,"byteOffset"),J(G,"byteLength"),J(G,"length")),n({target:"Object",stat:!0,forced:!j},{getOwnPropertyDescriptor:Z,defineProperty:X}),t.exports=function(t,e,r){var a=t.match(/\d+$/)[0]/8,s=t+(r?"Clamped":"")+"Array",u="get"+t,f="set"+t,h=i[s],v=h,m=v&&v.prototype,y={},w=function(t,e){var r=C(t);return r.view[u](e*a+r.byteOffset,!0)},B=function(t,e,n){var i=C(t);r&&(n=(n=R(n))<0?0:n>255?255:255&n),i.view[f](e*a+i.byteOffset,n,!0)},L=function(t,e){I(t,e,{get:function(){return w(this,e)},set:function(t){return B(this,e,t)},enumerable:!0})};j?o&&(v=e((function(t,e,r,n){return c(t,v,s),P(function(){return b(e)?H(e)?void 0!==n?new h(e,g(r,a),n):void 0!==r?new h(e,g(r,a)):new h(e):$(e)?q(v,e):T.call(v,e):new h(p(e))}(),t,v)})),A&&A(v,N),_(M(h),(function(t){t in v||l(v,t,h[t])})),v.prototype=m):(v=e((function(t,e,r,n){c(t,v,s);var i,o,u,f=0,l=0;if(b(e)){if(!H(e))return $(e)?q(v,e):T.call(v,e);i=e,l=g(r,a);var h=e.byteLength;if(void 0===n){if(h%a)throw D(Q);if(o=h-l,o<0)throw D(Q)}else if(o=d(n)*a,o+l>h)throw D(Q);u=o/a}else u=p(e),o=u*a,i=new O(o);F(t,{buffer:i,byteOffset:l,byteLength:o,length:u,view:new U(i)});while(f<u)L(t,f++)})),A&&A(v,N),m=v.prototype=x(G)),m.constructor!==v&&l(m,"constructor",v),l(m,W,v),z&&l(m,z,s),y[s]=v,n({global:!0,forced:v!=h,sham:!j},y),V in v||l(v,V,a),V in m||l(m,V,a),k(s)}):t.exports=function(){}},"77a7":function(t,e){var r=Math.abs,n=Math.pow,i=Math.floor,a=Math.log,o=Math.LN2,s=function(t,e,s){var u,c,f,l=new Array(s),h=8*s-e-1,d=(1<<h)-1,p=d>>1,g=23===e?n(2,-24)-n(2,-77):0,v=t<0||0===t&&1/t<0?1:0,m=0;for(t=r(t),t!=t||t===1/0?(c=t!=t?1:0,u=d):(u=i(a(t)/o),t*(f=n(2,-u))<1&&(u--,f*=2),t+=u+p>=1?g/f:g*n(2,1-p),t*f>=2&&(u++,f/=2),u+p>=d?(c=0,u=d):u+p>=1?(c=(t*f-1)*n(2,e),u+=p):(c=t*n(2,p-1)*n(2,e),u=0));e>=8;l[m++]=255&c,c/=256,e-=8);for(u=u<<e|c,h+=e;h>0;l[m++]=255&u,u/=256,h-=8);return l[--m]|=128*v,l},u=function(t,e){var r,i=t.length,a=8*i-e-1,o=(1<<a)-1,s=o>>1,u=a-7,c=i-1,f=t[c--],l=127&f;for(f>>=7;u>0;l=256*l+t[c],c--,u-=8);for(r=l&(1<<-u)-1,l>>=-u,u+=e;u>0;r=256*r+t[c],c--,u-=8);if(0===l)l=1-s;else{if(l===o)return r?NaN:f?-1/0:1/0;r+=n(2,e),l-=s}return(f?-1:1)*r*n(2,l-e)};t.exports={pack:s,unpack:u}},"7db0":function(t,e,r){"use strict";var n=r("23e7"),i=r("b727").find,a=r("44d2"),o="find",s=!0;o in[]&&Array(1)[o]((function(){s=!1})),n({target:"Array",proto:!0,forced:s},{find:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),a(o)},"81d5":function(t,e,r){"use strict";var n=r("7b0b"),i=r("23cb"),a=r("50c4");t.exports=function(t){var e=n(this),r=a(e.length),o=arguments.length,s=i(o>1?arguments[1]:void 0,r),u=o>2?arguments[2]:void 0,c=void 0===u?r:i(u,r);while(c>s)e[s++]=t;return e}},"82f8":function(t,e,r){"use strict";var n=r("ebb5"),i=r("4d64").includes,a=n.aTypedArray,o=n.exportTypedArrayMethod;o("includes",(function(t){return i(a(this),t,arguments.length>1?arguments[1]:void 0)}))},"8aa7":function(t,e,r){var n=r("da84"),i=r("d039"),a=r("1c7e"),o=r("ebb5").NATIVE_ARRAY_BUFFER_VIEWS,s=n.ArrayBuffer,u=n.Int8Array;t.exports=!o||!i((function(){u(1)}))||!i((function(){new u(-1)}))||!a((function(t){new u,new u(null),new u(1.5),new u(t)}),!0)||i((function(){return 1!==new u(new s(2),1,void 0).length}))},"90bd":function(t,e,r){"use strict";r("2d7f")},"9a8c":function(t,e,r){"use strict";var n=r("ebb5"),i=r("145e"),a=n.aTypedArray,o=n.exportTypedArrayMethod;o("copyWithin",(function(t,e){return i.call(a(this),t,e,arguments.length>2?arguments[2]:void 0)}))},"9c0cf":function(t,e,r){"use strict";(function(t){var n,i,a,o=r("53ca"),s=(r("fb6a"),r("a434"),r("ac1f"),r("466d"),r("b0c0"),r("159b"),r("d3b7"),r("5cc6"),r("9a8c"),r("a975"),r("735e"),r("c1ac"),r("d139"),r("3a7b"),r("d5d6"),r("82f8"),r("e91f"),r("60bd"),r("5f96"),r("3280"),r("3fcc"),r("ca91"),r("25a1"),r("cd26"),r("3c5d"),r("2954"),r("649e"),r("219c"),r("170b"),r("b39a"),r("72f7"),r("38cf"),r("fd7f"));function u(e){var n;"function"===typeof define&&r("3c35")?define([],e):(n="undefined"!==typeof window?window:"undefined"!==typeof t?t:"undefined"!==typeof self?self:this,n.GIF=e())}function c(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function f(){return function t(e,r,i){function a(s,u){if(!r[s]){if(!e[s]){var c="function"==typeof n&&n;if(!u&&c)return n(s,!0);if(o)return o(s,!0);var f=new Error("Cannot find module '"+s+"'");throw f.code="MODULE_NOT_FOUND",f}var l=r[s]={exports:{}};e[s][0].call(l.exports,(function(t){var r=e[s][1][t];return a(r||t)}),l,l.exports,t,e,r,i)}return r[s].exports}for(var o="function"==typeof n&&n,s=0;s<i.length;s++)a(i[s]);return a}({1:[function(t,e,r){function n(t){return"function"===typeof t}function i(t){return"number"===typeof t}function a(t){return"object"===Object(o["a"])(t)&&null!==t}function s(t){return void 0===t}c.EventEmitter=c,c.prototype._events=void 0,c.prototype._maxListeners=void 0,c.defaultMaxListeners=10,c.prototype.setMaxListeners=function(t){if(!i(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},c.prototype.emit=function(t){var e,r,i,o,u,c;if(this._events||(this._events={}),"error"===t&&(!this._events.error||a(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;var f=new Error('Uncaught, unspecified "error" event. ('+e+")");throw f.context=e,f}if(r=this._events[t],s(r))return!1;if(n(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:o=Array.prototype.slice.call(arguments,1),r.apply(this,o)}else if(a(r))for(o=Array.prototype.slice.call(arguments,1),c=r.slice(),i=c.length,u=0;u<i;u++)c[u].apply(this,o);return!0},c.prototype.addListener=function(t,e){var r;if(!n(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,n(e.listener)?e.listener:e),this._events[t]?a(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,a(this._events[t])&&!this._events[t].warned&&(r=s(this._maxListeners)?c.defaultMaxListeners:this._maxListeners,r&&r>0&&this._events[t].length>r&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"===typeof console.trace&&console.trace())),this},c.prototype.on=c.prototype.addListener,c.prototype.once=function(t,e){if(!n(e))throw TypeError("listener must be a function");var r=!1;function i(){this.removeListener(t,i),r||(r=!0,e.apply(this,arguments))}return i.listener=e,this.on(t,i),this},c.prototype.removeListener=function(t,e){var r,i,o,s;if(!n(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(r=this._events[t],o=r.length,i=-1,r===e||n(r.listener)&&r.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(a(r)){for(s=o;s-- >0;)if(r[s]===e||r[s].listener&&r[s].listener===e){i=s;break}if(i<0)return this;1===r.length?(r.length=0,delete this._events[t]):r.splice(i,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},c.prototype.removeAllListeners=function(t){var e,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[t],n(r))this.removeListener(t,r);else if(r)while(r.length)this.removeListener(t,r[r.length-1]);return delete this._events[t],this},c.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?n(this._events[t])?[this._events[t]]:this._events[t].slice():[],e},c.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(n(e))return 1;if(e)return e.length}return 0},c.listenerCount=function(t,e){return t.listenerCount(e)}},{}],2:[function(t,e,r){var n,a,o,s;s=navigator.userAgent.toLowerCase(),o=navigator.platform.toLowerCase(),n=s.match(/(opera|ie|firefox|chrome|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,"unknown",0],a="ie"===n[1]&&document.documentMode,i={name:"version"===n[1]?n[3]:n[1],version:a||parseFloat("opera"===n[1]&&n[4]?n[4]:n[2]),platform:{name:s.match(/ip(?:ad|od|hone)/)?"ios":(s.match(/(?:webos|android)/)||o.match(/mac|win|linux/)||["other"])[0]}},i[i.name]=!0,i[i.name+parseInt(i.version,10)]=!0,i.platform[i.platform.name]=!0},{}],3:[function(t,e,r,n,o){var u=function(t,e){for(var r in e)f.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},f={}.hasOwnProperty,l=[].indexOf||function(t){for(var e=0,r=this.length;e<r;e++)if(e in this&&this[e]===t)return e;return-1},h=[].slice;o[1][0](),o[2][0](),a=function(t){var e,r;function n(t){var r,n,i;for(n in this.running=!1,this.options={},this.frames=[],this.freeWorkers=[],this.activeWorkers=[],this.setOptions(t),e)i=e[n],null==(r=this.options)[n]&&(r[n]=i)}return u(n,t),e={workerScript:"gif.worker.js",workers:2,repeat:0,background:"#fff",quality:10,width:null,height:null,transparent:null,debug:!1,dither:!1},r={delay:500,copy:!1},n.prototype.setOption=function(t,e){if(this.options[t]=e,null!=this._canvas&&("width"===t||"height"===t))return this._canvas[t]=e},n.prototype.setOptions=function(t){var e,r,n;for(e in r=[],t)f.call(t,e)&&(n=t[e],r.push(this.setOption(e,n)));return r},n.prototype.addFrame=function(t,e){var n,i;for(i in null==e&&(e={}),n={},n.transparent=this.options.transparent,r)n[i]=e[i]||r[i];if(null==this.options.width&&this.setOption("width",t.width),null==this.options.height&&this.setOption("height",t.height),"undefined"!==typeof ImageData&&null!==ImageData&&t instanceof ImageData)n.data=t.data;else if("undefined"!==typeof CanvasRenderingContext2D&&null!==CanvasRenderingContext2D&&t instanceof CanvasRenderingContext2D||"undefined"!==typeof WebGLRenderingContext&&null!==WebGLRenderingContext&&t instanceof WebGLRenderingContext)e.copy?n.data=this.getContextData(t):n.context=t;else{if(null==t.childNodes)throw new Error("Invalid image");e.copy?n.data=this.getImageData(t):n.image=t}return this.frames.push(n)},n.prototype.render=function(){var t,e,r;if(this.running)throw new Error("Already running");if(null==this.options.width||null==this.options.height)throw new Error("Width and height must be set prior to rendering");if(this.running=!0,this.nextFrame=0,this.finishedFrames=0,this.imageParts=function(){var t,e,r;for(r=[],t=0,e=this.frames.length;0<=e?t<e:t>e;0<=e?++t:--t)r.push(null);return r}.call(this),e=this.spawnWorkers(),!0===this.options.globalPalette)this.renderNextFrame();else for(t=0,r=e;0<=r?t<r:t>r;0<=r?++t:--t)this.renderNextFrame();return this.emit("start"),this.emit("progress",0)},n.prototype.abort=function(){var t;while(1){if(t=this.activeWorkers.shift(),null==t)break;this.log("killing active worker"),t.terminate()}return this.running=!1,this.emit("abort")},n.prototype.spawnWorkers=function(){var t,e,r;return t=Math.min(this.options.workers,this.frames.length),function(){r=[];for(var n=e=this.freeWorkers.length;e<=t?n<t:n>t;e<=t?n++:n--)r.push(n);return r}.apply(this).forEach(function(t){return function(e){var r;return t.log("spawning worker "+e),r=new s["a"],r.onmessage=function(e){return t.activeWorkers.splice(t.activeWorkers.indexOf(r),1),t.freeWorkers.push(r),t.frameFinished(e.data)},t.freeWorkers.push(r)}}(this)),t},n.prototype.frameFinished=function(t){var e,r;if(this.log("frame "+t.index+" finished - "+this.activeWorkers.length+" active"),this.finishedFrames++,this.emit("progress",this.finishedFrames/this.frames.length),this.imageParts[t.index]=t,!0===this.options.globalPalette&&(this.options.globalPalette=t.globalPalette,this.log("global palette analyzed"),this.frames.length>2))for(e=1,r=this.freeWorkers.length;1<=r?e<r:e>r;1<=r?++e:--e)this.renderNextFrame();return l.call(this.imageParts,null)>=0?this.renderNextFrame():this.finishRendering()},n.prototype.finishRendering=function(){var t,e,r,n,i,a,o,s,u,c,f,l,h,d,p,g;for(s=0,d=this.imageParts,i=0,u=d.length;i<u;i++)e=d[i],s+=(e.data.length-1)*e.pageSize+e.cursor;for(s+=e.pageSize-e.cursor,this.log("rendering finished - filesize "+Math.round(s/1e3)+"kb"),t=new Uint8Array(s),l=0,p=this.imageParts,a=0,c=p.length;a<c;a++)for(e=p[a],g=e.data,r=o=0,f=g.length;o<f;r=++o)h=g[r],t.set(h,l),r===e.data.length-1?l+=e.cursor:l+=e.pageSize;return n=new Blob([t],{type:"image/gif"}),this.emit("finished",n,t)},n.prototype.renderNextFrame=function(){var t,e,r;if(0===this.freeWorkers.length)throw new Error("No free workers");if(!(this.nextFrame>=this.frames.length))return t=this.frames[this.nextFrame++],r=this.freeWorkers.shift(),e=this.getTask(t),this.log("starting frame "+(e.index+1)+" of "+this.frames.length),this.activeWorkers.push(r),r.postMessage(e)},n.prototype.getContextData=function(t){return t.getImageData(0,0,this.options.width,this.options.height).data},n.prototype.getImageData=function(t){var e;return null==this._canvas&&(this._canvas=document.createElement("canvas"),this._canvas.width=this.options.width,this._canvas.height=this.options.height),e=this._canvas.getContext("2d"),e.setFill=this.options.background,e.fillRect(0,0,this.options.width,this.options.height),e.drawImage(t,0,0),this.getContextData(e)},n.prototype.getTask=function(t){var e,r;if(e=this.frames.indexOf(t),r={index:e,last:e===this.frames.length-1,delay:t.delay,transparent:t.transparent,width:this.options.width,height:this.options.height,quality:this.options.quality,dither:this.options.dither,globalPalette:this.options.globalPalette,repeat:this.options.repeat,canTransfer:"chrome"===i.name},null!=t.data)r.data=t.data;else if(null!=t.context)r.data=this.getContextData(t.context);else{if(null==t.image)throw new Error("Invalid frame");r.data=this.getImageData(t.image)}return r},n.prototype.log=function(){var t;if(t=1<=arguments.length?h.call(arguments,0):[],this.options.debug)return console.log.apply(console,t)},n}(c)},{"./browser.coffee":2,events:1}]},{},[3])(3)}u(f),e["a"]=a}).call(this,r("c8ba"))},a078:function(t,e,r){var n=r("7b0b"),i=r("50c4"),a=r("35a1"),o=r("e95a"),s=r("0366"),u=r("ebb5").aTypedArrayConstructor;t.exports=function(t){var e,r,c,f,l,h,d=n(t),p=arguments.length,g=p>1?arguments[1]:void 0,v=void 0!==g,m=a(d);if(void 0!=m&&!o(m)){l=m.call(d),h=l.next,d=[];while(!(f=h.call(l)).done)d.push(f.value)}for(v&&p>2&&(g=s(g,arguments[2],2)),r=i(d.length),c=new(u(this))(r),e=0;r>e;e++)c[e]=v?g(d[e],e):d[e];return c}},a365:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.decompressFrames=e.decompressFrame=e.parseGIF=void 0;var n=u(r("2cfc")),i=r("e962"),a=r("584f"),o=r("ebdf"),s=r("bfc6");function u(t){return t&&t.__esModule?t:{default:t}}var c=function(t){var e=new Uint8Array(t);return(0,i.parse)((0,a.buildStream)(e),n["default"])};e.parseGIF=c;var f=function(t){for(var e=t.pixels.length,r=new Uint8ClampedArray(4*e),n=0;n<e;n++){var i=4*n,a=t.pixels[n],o=t.colorTable[a]||[0,0,0];r[i]=o[0],r[i+1]=o[1],r[i+2]=o[2],r[i+3]=a!==t.transparentIndex?255:0}return r},l=function(t,e,r){if(t.image){var n=t.image,i=n.descriptor.width*n.descriptor.height,a=(0,s.lzw)(n.data.minCodeSize,n.data.blocks,i);n.descriptor.lct.interlaced&&(a=(0,o.deinterlace)(a,n.descriptor.width));var u={pixels:a,dims:{top:t.image.descriptor.top,left:t.image.descriptor.left,width:t.image.descriptor.width,height:t.image.descriptor.height}};return n.descriptor.lct&&n.descriptor.lct.exists?u.colorTable=n.lct:u.colorTable=e,t.gce&&(u.delay=10*(t.gce.delay||10),u.disposalType=t.gce.extras.disposal,t.gce.extras.transparentColorGiven&&(u.transparentIndex=t.gce.transparentColorIndex)),r&&(u.patch=f(u)),u}console.warn("gif frame does not have associated image.")};e.decompressFrame=l;var h=function(t,e){return t.frames.filter((function(t){return t.image})).map((function(r){return l(r,t.gct,e)}))};e.decompressFrames=h},a434:function(t,e,r){"use strict";var n=r("23e7"),i=r("23cb"),a=r("a691"),o=r("50c4"),s=r("7b0b"),u=r("65f0"),c=r("8418"),f=r("1dde"),l=f("splice"),h=Math.max,d=Math.min,p=9007199254740991,g="Maximum allowed length exceeded";n({target:"Array",proto:!0,forced:!l},{splice:function(t,e){var r,n,f,l,v,m,y=s(this),b=o(y.length),w=i(t,b),x=arguments.length;if(0===x?r=n=0:1===x?(r=0,n=b-w):(r=x-2,n=d(h(a(e),0),b-w)),b+r-n>p)throw TypeError(g);for(f=u(y,n),l=0;l<n;l++)v=w+l,v in y&&c(f,l,y[v]);if(f.length=n,r<n){for(l=w;l<b-n;l++)v=l+n,m=l+r,v in y?y[m]=y[v]:delete y[m];for(l=b;l>b-n+r;l--)delete y[l-1]}else if(r>n)for(l=b-n;l>w;l--)v=l+n-1,m=l+r-1,v in y?y[m]=y[v]:delete y[m];for(l=0;l<r;l++)y[l+w]=arguments[l+2];return y.length=b-n+r,f}})},a640:function(t,e,r){"use strict";var n=r("d039");t.exports=function(t,e){var r=[][t];return!!r&&n((function(){r.call(null,e||function(){throw 1},1)}))}},a975:function(t,e,r){"use strict";var n=r("ebb5"),i=r("b727").every,a=n.aTypedArray,o=n.exportTypedArrayMethod;o("every",(function(t){return i(a(this),t,arguments.length>1?arguments[1]:void 0)}))},a981:function(t,e){t.exports="undefined"!==typeof ArrayBuffer&&"undefined"!==typeof DataView},addb:function(t,e){var r=Math.floor,n=function(t,e){var o=t.length,s=r(o/2);return o<8?i(t,e):a(n(t.slice(0,s),e),n(t.slice(s),e),e)},i=function(t,e){var r,n,i=t.length,a=1;while(a<i){n=a,r=t[a];while(n&&e(t[n-1],r)>0)t[n]=t[--n];n!==a++&&(t[n]=r)}return t},a=function(t,e,r){var n=t.length,i=e.length,a=0,o=0,s=[];while(a<n||o<i)a<n&&o<i?s.push(r(t[a],e[o])<=0?t[a++]:e[o++]):s.push(a<n?t[a++]:e[o++]);return s};t.exports=n},b39a:function(t,e,r){"use strict";var n=r("da84"),i=r("ebb5"),a=r("d039"),o=n.Int8Array,s=i.aTypedArray,u=i.exportTypedArrayMethod,c=[].toLocaleString,f=[].slice,l=!!o&&a((function(){c.call(new o(1))})),h=a((function(){return[1,2].toLocaleString()!=new o([1,2]).toLocaleString()}))||!a((function(){o.prototype.toLocaleString.call([1,2])}));u("toLocaleString",(function(){return c.apply(l?f.call(s(this)):s(this),arguments)}),h)},b6b7:function(t,e,r){var n=r("ebb5"),i=r("4840"),a=n.TYPED_ARRAY_CONSTRUCTOR,o=n.aTypedArrayConstructor;t.exports=function(t){return o(i(t,t[a]))}},bfc6:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.lzw=void 0;var n=function(t,e,r){var n,i,a,o,s,u,c,f,l,h,d,p,g,v,m,y,b=4096,w=-1,x=r,A=new Array(r),M=new Array(b),T=new Array(b),_=new Array(b+1);for(h=t,i=1<<h,s=i+1,n=i+2,c=w,o=h+1,a=(1<<o)-1,f=0;f<i;f++)M[f]=0,T[f]=f;for(d=p=g=v=m=y=0,l=0;l<x;){if(0===v){if(p<o){d+=e[y]<<p,p+=8,y++;continue}if(f=d&a,d>>=o,p-=o,f>n||f==s)break;if(f==i){o=h+1,a=(1<<o)-1,n=i+2,c=w;continue}if(c==w){_[v++]=T[f],c=f,g=f;continue}u=f,f==n&&(_[v++]=g,f=c);while(f>i)_[v++]=T[f],f=M[f];g=255&T[f],_[v++]=g,n<b&&(M[n]=c,T[n]=g,n++,0===(n&a)&&n<b&&(o++,a+=n)),c=u}v--,A[m++]=_[v],l++}for(l=m;l<x;l++)A[l]=0;return A};e.lzw=n},c1ac:function(t,e,r){"use strict";var n=r("ebb5"),i=r("b727").filter,a=r("1448"),o=n.aTypedArray,s=n.exportTypedArrayMethod;s("filter",(function(t){var e=i(o(this),t,arguments.length>1?arguments[1]:void 0);return a(this,e)}))},ca91:function(t,e,r){"use strict";var n=r("ebb5"),i=r("d58f").left,a=n.aTypedArray,o=n.exportTypedArrayMethod;o("reduce",(function(t){return i(a(this),t,arguments.length,arguments.length>1?arguments[1]:void 0)}))},cca1:function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"flex ai-c",attrs:{id:"gen-gif","element-loading-text":"正在生成...","element-loading-spinner":"el-icon-loading","element-loading-customClass":"loading"}},[r("div",{staticClass:"gen-gif-preview flex"},[r("div",{staticClass:"img-box flex"},[t._m(0),r("img",{attrs:{src:t.gif||t.gifMap[t.mode].url,alt:""}}),r("div",{staticClass:"action flex"},[r("el-upload",{ref:"upload",attrs:{action:"","auto-upload":!1,"show-file-list":!1,accept:".gif","on-change":t.handleUploadChange,limit:1}},[r("el-button",{attrs:{type:"text"}},[r("i",{staticClass:"el-icon-circle-plus-outline"}),t._v(t._s("custom"===t.mode?"重新选择":"选择本地图片"))])],1),r("el-button",{directives:[{name:"show",rawName:"v-show",value:"custom"===t.mode,expression:"mode === 'custom'"}],staticStyle:{"margin-left":"10px"},attrs:{type:"text"},on:{click:t.cancelSelect}},[r("i",{staticClass:"el-icon-circle-close"}),t._v("取消选择")])],1)]),r("div",{staticClass:"img-box flex"},[t._m(1),r("img",{attrs:{src:t.gifMap[t.mode].currentFramePreview,alt:""}}),r("p",{directives:[{name:"show",rawName:"v-show",value:!t.gifMap[t.mode].currentFramePreview,expression:"!gifMap[mode].currentFramePreview"}],staticClass:"flex jc-c ai-c"},[t._v(" 加载中... ")]),r("div",{staticClass:"action flex ai-c"},[r("div",{staticStyle:{"margin-right":"20px"}},[t._v("当前帧")]),r("el-slider",{staticStyle:{flex:"1"},attrs:{max:t.gifMap[t.mode].frameList.length-1>0?t.gifMap[t.mode].frameList.length-1:1,"format-tooltip":function(t){return++t}},on:{input:t.changeFrame},model:{value:t.gifMap[t.mode].currentFrameIndex,callback:function(e){t.$set(t.gifMap[t.mode],"currentFrameIndex",e)},expression:"gifMap[mode].currentFrameIndex"}}),r("div",{staticStyle:{"margin-left":"20px"}},[t._v(" "+t._s(t.gifMap[t.mode].currentFrameIndex+1+" / "+t.gifMap[t.mode].frameList.length)+" ")])],1)])]),r("div",{staticClass:"gen-gif-content"},[r("h3",[t._v("内容编辑")]),t._l(t.gifMap[t.mode].metaData.textList,(function(e,n){return r("div",{key:e.key,staticClass:"text-item"},[r("label",{attrs:{for:"text"+n}},[t._v("请输入第 "+t._s(n+1)+" 句内容")]),r("div",{staticClass:"flex ai-c",staticStyle:{"line-height":"14px"}},[r("el-input",{staticClass:"el-text",attrs:{id:"text"+n,maxlength:15},model:{value:e.value,callback:function(r){t.$set(e,"value",r)},expression:"item.value"}}),[r("el-input",{staticClass:"el-frame-index",attrs:{type:"number"},on:{blur:function(r){e.start=t.formatNumber(e.start,1,t.gifMap[t.mode].frameList.length||1)}},model:{value:e.start,callback:function(r){t.$set(e,"start",r)},expression:"item.start"}}),t._v("  ~  "),r("el-input",{staticClass:"el-frame-index",attrs:{type:"number"},on:{blur:function(r){e.end=t.formatNumber(e.end,1,t.gifMap[t.mode].frameList.length||1)}},model:{value:e.end,callback:function(r){t.$set(e,"end",r)},expression:"item.end"}}),t._v("  帧 "),r("el-button",{staticClass:"el-del-text-btn",attrs:{icon:"el-icon-delete",circle:""},on:{click:function(e){return t.handleDeleteText(n)}}})]],2)])})),r("div",{staticClass:"add-btn"},[r("div",{staticClass:"flex ai-c",staticStyle:{margin:"4px 0 16px 0"}},[r("el-button",{staticClass:"el-add-text-btn",attrs:{type:"primary",icon:"el-icon-plus",plain:""},on:{click:t.handleAddText}},[t._v("添加内容")]),r("div",{staticClass:"flex ai-c h50"},[r("label",{staticStyle:{margin:"0 8px"},attrs:{for:"blackRect"}},[t._v("添加黑边")]),r("el-switch",{attrs:{id:"blackRect"},model:{value:t.gifMap[t.mode].metaData.blackRect,callback:function(e){t.$set(t.gifMap[t.mode].metaData,"blackRect",e)},expression:"gifMap[mode].metaData.blackRect"}})],1)],1)]),[r("h3",[t._v("文本设置")]),r("div",{staticClass:"text-set-wrap"},[r("label",{attrs:{for:"fontSize"}},[t._v("字号")]),r("el-input-number",{staticClass:"mr-16",attrs:{id:"fontSize",size:"mini",value:t.gifMap[t.mode].metaData.textList[0]?t.gifMap[t.mode].metaData.textList[0].fontSize:1,min:1},on:{change:function(e){return t.handleChangeTextItem("fontSize",e)}}}),r("label",{staticClass:"text-r20",attrs:{for:"strokeWidth"}},[t._v("文字描边")]),r("el-input-number",{attrs:{id:"strokeWidth",size:"mini",value:t.gifMap[t.mode].metaData.textList[0]?t.gifMap[t.mode].metaData.textList[0].strokeWidth:.1,step:.1,min:0},on:{change:function(e){return t.handleChangeTextItem("strokeWidth",e)}}})],1)]],2),r("section",{staticClass:"gen-gif-font"}),r("div",{staticClass:"btn"},[t.gifMap[t.mode].frameList.length?r("el-button",{on:{click:t.generateGif}},[t._v("生成")]):t._e(),t.gif?r("el-button",{on:{click:function(e){return t.download(t.gif,"gif")}}},[t._v("下载")]):r("el-button",{on:{click:function(e){return t.downloadDefaultImg(t.gifMap[t.mode].url)}}},[t._v("下载")])],1)])},i=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("h2",[r("i",{staticClass:"el-icon-edit-outline"}),t._v(" 表情制作")])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("h2",[r("i",{staticClass:"el-icon-s-operation"}),t._v(" 逐帧查看")])}],a=r("6685"),o=a["a"],s=(r("90bd"),r("2877")),u=Object(s["a"])(o,n,i,!1,null,"036d284c",null);e["default"]=u.exports},cd26:function(t,e,r){"use strict";var n=r("ebb5"),i=n.aTypedArray,a=n.exportTypedArrayMethod,o=Math.floor;a("reverse",(function(){var t,e=this,r=i(e).length,n=o(r/2),a=0;while(a<n)t=e[a],e[a++]=e[--r],e[r]=t;return e}))},d139:function(t,e,r){"use strict";var n=r("ebb5"),i=r("b727").find,a=n.aTypedArray,o=n.exportTypedArrayMethod;o("find",(function(t){return i(a(this),t,arguments.length>1?arguments[1]:void 0)}))},d58f:function(t,e,r){var n=r("1c0b"),i=r("7b0b"),a=r("44ad"),o=r("50c4"),s=function(t){return function(e,r,s,u){n(r);var c=i(e),f=a(c),l=o(c.length),h=t?l-1:0,d=t?-1:1;if(s<2)while(1){if(h in f){u=f[h],h+=d;break}if(h+=d,t?h<0:l<=h)throw TypeError("Reduce of empty array with no initial value")}for(;t?h>=0:l>h;h+=d)h in f&&(u=r(u,f[h],h,c));return u}};t.exports={left:s(!1),right:s(!0)}},d5d6:function(t,e,r){"use strict";var n=r("ebb5"),i=r("b727").forEach,a=n.aTypedArray,o=n.exportTypedArrayMethod;o("forEach",(function(t){i(a(this),t,arguments.length>1?arguments[1]:void 0)}))},d998:function(t,e,r){var n=r("342f");t.exports=/MSIE|Trident/.test(n)},dfb9:function(t,e){t.exports=function(t,e){var r=0,n=e.length,i=new t(n);while(n>r)i[r]=e[r++];return i}},e58c:function(t,e,r){"use strict";var n=r("fc6a"),i=r("a691"),a=r("50c4"),o=r("a640"),s=Math.min,u=[].lastIndexOf,c=!!u&&1/[1].lastIndexOf(1,-0)<0,f=o("lastIndexOf"),l=c||!f;t.exports=l?function(t){if(c)return u.apply(this,arguments)||0;var e=n(this),r=a(e.length),o=r-1;for(arguments.length>1&&(o=s(o,i(arguments[1]))),o<0&&(o=r+o);o>=0;o--)if(o in e&&e[o]===t)return o||0;return-1}:u},e91f:function(t,e,r){"use strict";var n=r("ebb5"),i=r("4d64").indexOf,a=n.aTypedArray,o=n.exportTypedArrayMethod;o("indexOf",(function(t){return i(a(this),t,arguments.length>1?arguments[1]:void 0)}))},e962:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.loop=e.conditional=e.parse=void 0;var n=function t(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n;if(Array.isArray(r))r.forEach((function(r){return t(e,r,n,i)}));else if("function"===typeof r)r(e,n,i,t);else{var a=Object.keys(r)[0];Array.isArray(r[a])?(i[a]={},t(e,r[a],n,i[a])):i[a]=r[a](e,n,i,t)}return n};e.parse=n;var i=function(t,e){return function(r,n,i,a){e(r,n,i)&&a(r,t,n,i)}};e.conditional=i;var a=function(t,e){return function(r,n,i,a){var o=[];while(e(r,n,i)){var s={};a(r,t,n,s),o.push(s)}return o}};e.loop=a},ebb5:function(t,e,r){"use strict";var n,i,a,o=r("a981"),s=r("83ab"),u=r("da84"),c=r("861d"),f=r("5135"),l=r("f5df"),h=r("9112"),d=r("6eeb"),p=r("9bf2").f,g=r("e163"),v=r("d2bb"),m=r("b622"),y=r("90e3"),b=u.Int8Array,w=b&&b.prototype,x=u.Uint8ClampedArray,A=x&&x.prototype,M=b&&g(b),T=w&&g(w),_=Object.prototype,k=_.isPrototypeOf,B=m("toStringTag"),L=y("TYPED_ARRAY_TAG"),S=y("TYPED_ARRAY_CONSTRUCTOR"),P=o&&!!v&&"Opera"!==l(u.opera),C=!1,F={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},I={BigInt64Array:8,BigUint64Array:8},E=function(t){if(!c(t))return!1;var e=l(t);return"DataView"===e||f(F,e)||f(I,e)},R=function(t){if(!c(t))return!1;var e=l(t);return f(F,e)||f(I,e)},D=function(t){if(R(t))return t;throw TypeError("Target is not a typed array")},O=function(t){if(v&&!k.call(M,t))throw TypeError("Target is not a typed array constructor");return t},U=function(t,e,r){if(s){if(r)for(var n in F){var i=u[n];if(i&&f(i.prototype,t))try{delete i.prototype[t]}catch(a){}}T[t]&&!r||d(T,t,r?e:P&&w[t]||e)}},j=function(t,e,r){var n,i;if(s){if(v){if(r)for(n in F)if(i=u[n],i&&f(i,t))try{delete i[t]}catch(a){}if(M[t]&&!r)return;try{return d(M,t,r?e:P&&M[t]||e)}catch(a){}}for(n in F)i=u[n],!i||i[t]&&!r||d(i,t,e)}};for(n in F)i=u[n],a=i&&i.prototype,a?h(a,S,i):P=!1;for(n in I)i=u[n],a=i&&i.prototype,a&&h(a,S,i);if((!P||"function"!=typeof M||M===Function.prototype)&&(M=function(){throw TypeError("Incorrect invocation")},P))for(n in F)u[n]&&v(u[n],M);if((!P||!T||T===_)&&(T=M.prototype,P))for(n in F)u[n]&&v(u[n].prototype,T);if(P&&g(A)!==T&&v(A,T),s&&!f(T,B))for(n in C=!0,p(T,B,{get:function(){return c(this)?this[L]:void 0}}),F)u[n]&&h(u[n],L,n);t.exports={NATIVE_ARRAY_BUFFER_VIEWS:P,TYPED_ARRAY_CONSTRUCTOR:S,TYPED_ARRAY_TAG:C&&L,aTypedArray:D,aTypedArrayConstructor:O,exportTypedArrayMethod:U,exportTypedArrayStaticMethod:j,isView:E,isTypedArray:R,TypedArray:M,TypedArrayPrototype:T}},ebdf:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.deinterlace=void 0;var n=function(t,e){for(var r=new Array(t.length),n=t.length/e,i=function(n,i){var a=t.slice(i*e,(i+1)*e);r.splice.apply(r,[n*e,e].concat(a))},a=[0,4,2,1],o=[8,8,4,2],s=0,u=0;u<4;u++)for(var c=a[u];c<n;c+=o[u])i(c,s),s++;return r};e.deinterlace=n},ecd6:function(t,e,r){"use strict";t.exports=function(t,e,r,n){var i=self||window;try{try{var a;try{a=new i.Blob([t])}catch(f){var o=i.BlobBuilder||i.WebKitBlobBuilder||i.MozBlobBuilder||i.MSBlobBuilder;a=new o,a.append(t),a=a.getBlob()}var s=i.URL||i.webkitURL,u=s.createObjectURL(a),c=new i[e](u,r);return s.revokeObjectURL(u),c}catch(f){return new i[e]("data:application/javascript,".concat(encodeURIComponent(t)),r)}}catch(f){if(!n)throw Error("Inline worker is not supported");return new i[e](n,r)}}},f8cd:function(t,e,r){var n=r("a691");t.exports=function(t){var e=n(t);if(e<0)throw RangeError("The argument can't be less than 0");return e}},fd7f:function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));var n=r("ecd6"),i=r.n(n);function a(){return i()('(function(t){var e={};function i(r){if(e[r])return e[r].exports;var n=e[r]={i:r,l:!1,exports:{}};return t[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/",i(i.s="7020")})({7020:function(t,e,i){var r;(function t(e,i,n){function o(a,h){if(!i[a]){if(!e[a]){var l="function"==typeof r&&r;if(!h&&l)return r(a,!0);if(s)return s(a,!0);var u=new Error("Cannot find module \'"+a+"\'");throw u.code="MODULE_NOT_FOUND",u}var p=i[a]={exports:{}};e[a][0].call(p.exports,(function(t){var i=e[a][1][t];return o(i||t)}),p,p.exports,t,e,i,n)}return i[a].exports}for(var s="function"==typeof r&&r,a=0;a<n.length;a++)o(n[a]);return o})({1:[function(t,e,i){var r=t("./TypedNeuQuant.js"),n=t("./LZWEncoder.js");function o(){this.page=-1,this.pages=[],this.newPage()}o.pageSize=4096,o.charMap={};for(var s=0;s<256;s++)o.charMap[s]=String.fromCharCode(s);function a(t,e){this.width=~~t,this.height=~~e,this.transparent=null,this.transIndex=0,this.repeat=-1,this.delay=0,this.image=null,this.pixels=null,this.indexedPixels=null,this.colorDepth=null,this.colorTab=null,this.neuQuant=null,this.usedEntry=new Array,this.palSize=7,this.dispose=-1,this.firstFrame=!0,this.sample=10,this.dither=!1,this.globalPalette=!1,this.out=new o}o.prototype.newPage=function(){this.pages[++this.page]=new Uint8Array(o.pageSize),this.cursor=0},o.prototype.getData=function(){for(var t="",e=0;e<this.pages.length;e++)for(var i=0;i<o.pageSize;i++)t+=o.charMap[this.pages[e][i]];return t},o.prototype.writeByte=function(t){this.cursor>=o.pageSize&&this.newPage(),this.pages[this.page][this.cursor++]=t},o.prototype.writeUTFBytes=function(t){for(var e=t.length,i=0;i<e;i++)this.writeByte(t.charCodeAt(i))},o.prototype.writeBytes=function(t,e,i){for(var r=i||t.length,n=e||0;n<r;n++)this.writeByte(t[n])},a.prototype.setDelay=function(t){this.delay=Math.round(t/10)},a.prototype.setFrameRate=function(t){this.delay=Math.round(100/t)},a.prototype.setDispose=function(t){t>=0&&(this.dispose=t)},a.prototype.setRepeat=function(t){this.repeat=t},a.prototype.setTransparent=function(t){this.transparent=t},a.prototype.addFrame=function(t){this.image=t,this.colorTab=this.globalPalette&&this.globalPalette.slice?this.globalPalette:null,this.getImagePixels(),this.analyzePixels(),!0===this.globalPalette&&(this.globalPalette=this.colorTab),this.firstFrame&&(this.writeLSD(),this.writePalette(),this.repeat>=0&&this.writeNetscapeExt()),this.writeGraphicCtrlExt(),this.writeImageDesc(),this.firstFrame||this.globalPalette||this.writePalette(),this.writePixels(),this.firstFrame=!1},a.prototype.finish=function(){this.out.writeByte(59)},a.prototype.setQuality=function(t){t<1&&(t=1),this.sample=t},a.prototype.setDither=function(t){!0===t&&(t="FloydSteinberg"),this.dither=t},a.prototype.setGlobalPalette=function(t){this.globalPalette=t},a.prototype.getGlobalPalette=function(){return this.globalPalette&&this.globalPalette.slice&&this.globalPalette.slice(0)||this.globalPalette},a.prototype.writeHeader=function(){this.out.writeUTFBytes("GIF89a")},a.prototype.analyzePixels=function(){this.colorTab||(this.neuQuant=new r(this.pixels,this.sample),this.neuQuant.buildColormap(),this.colorTab=this.neuQuant.getColormap()),this.dither?this.ditherPixels(this.dither.replace("-serpentine",""),null!==this.dither.match(/-serpentine/)):this.indexPixels(),this.pixels=null,this.colorDepth=8,this.palSize=7,null!==this.transparent&&(this.transIndex=this.findClosest(this.transparent,!0))},a.prototype.indexPixels=function(t){var e=this.pixels.length/3;this.indexedPixels=new Uint8Array(e);for(var i=0,r=0;r<e;r++){var n=this.findClosestRGB(255&this.pixels[i++],255&this.pixels[i++],255&this.pixels[i++]);this.usedEntry[n]=!0,this.indexedPixels[r]=n}},a.prototype.ditherPixels=function(t,e){var i={FalseFloydSteinberg:[[3/8,1,0],[3/8,0,1],[2/8,1,1]],FloydSteinberg:[[7/16,1,0],[3/16,-1,1],[5/16,0,1],[1/16,1,1]],Stucki:[[8/42,1,0],[4/42,2,0],[2/42,-2,1],[4/42,-1,1],[8/42,0,1],[4/42,1,1],[2/42,2,1],[1/42,-2,2],[2/42,-1,2],[4/42,0,2],[2/42,1,2],[1/42,2,2]],Atkinson:[[1/8,1,0],[1/8,2,0],[1/8,-1,1],[1/8,0,1],[1/8,1,1],[1/8,0,2]]};if(!t||!i[t])throw"Unknown dithering kernel: "+t;var r=i[t],n=0,o=this.height,s=this.width,a=this.pixels,h=e?-1:1;this.indexedPixels=new Uint8Array(this.pixels.length/3);for(var l=0;l<o;l++){e&&(h*=-1);for(var u=1==h?0:s-1,p=1==h?s:0;u!==p;u+=h){n=l*s+u;var f=3*n,c=a[f],y=a[f+1],d=a[f+2];f=this.findClosestRGB(c,y,d),this.usedEntry[f]=!0,this.indexedPixels[n]=f,f*=3;for(var w=this.colorTab[f],g=this.colorTab[f+1],b=this.colorTab[f+2],x=c-w,v=y-g,P=d-b,m=1==h?0:r.length-1,B=1==h?r.length:0;m!==B;m+=h){var S=r[m][1],T=r[m][2];if(S+u>=0&&S+u<s&&T+l>=0&&T+l<o){var M=r[m][0];f=n+S+T*s,f*=3,a[f]=Math.max(0,Math.min(255,a[f]+x*M)),a[f+1]=Math.max(0,Math.min(255,a[f+1]+v*M)),a[f+2]=Math.max(0,Math.min(255,a[f+2]+P*M))}}}}},a.prototype.findClosest=function(t,e){return this.findClosestRGB((16711680&t)>>16,(65280&t)>>8,255&t,e)},a.prototype.findClosestRGB=function(t,e,i,r){if(null===this.colorTab)return-1;if(this.neuQuant&&!r)return this.neuQuant.lookupRGB(t,e,i);for(var n=0,o=16777216,s=this.colorTab.length,a=0,h=0;a<s;h++){var l=t-(255&this.colorTab[a++]),u=e-(255&this.colorTab[a++]),p=i-(255&this.colorTab[a++]),f=l*l+u*u+p*p;(!r||this.usedEntry[h])&&f<o&&(o=f,n=h)}return n},a.prototype.getImagePixels=function(){var t=this.width,e=this.height;this.pixels=new Uint8Array(t*e*3);for(var i=this.image,r=0,n=0,o=0;o<e;o++)for(var s=0;s<t;s++)this.pixels[n++]=i[r++],this.pixels[n++]=i[r++],this.pixels[n++]=i[r++],r++},a.prototype.writeGraphicCtrlExt=function(){var t,e;this.out.writeByte(33),this.out.writeByte(249),this.out.writeByte(4),null===this.transparent?(t=0,e=0):(t=1,e=2),this.dispose>=0&&(e=7&dispose),e<<=2,this.out.writeByte(0|e|t),this.writeShort(this.delay),this.out.writeByte(this.transIndex),this.out.writeByte(0)},a.prototype.writeImageDesc=function(){this.out.writeByte(44),this.writeShort(0),this.writeShort(0),this.writeShort(this.width),this.writeShort(this.height),this.firstFrame||this.globalPalette?this.out.writeByte(0):this.out.writeByte(128|this.palSize)},a.prototype.writeLSD=function(){this.writeShort(this.width),this.writeShort(this.height),this.out.writeByte(240|this.palSize),this.out.writeByte(0),this.out.writeByte(0)},a.prototype.writeNetscapeExt=function(){this.out.writeByte(33),this.out.writeByte(255),this.out.writeByte(11),this.out.writeUTFBytes("NETSCAPE2.0"),this.out.writeByte(3),this.out.writeByte(1),this.writeShort(this.repeat),this.out.writeByte(0)},a.prototype.writePalette=function(){this.out.writeBytes(this.colorTab);for(var t=768-this.colorTab.length,e=0;e<t;e++)this.out.writeByte(0)},a.prototype.writeShort=function(t){this.out.writeByte(255&t),this.out.writeByte(t>>8&255)},a.prototype.writePixels=function(){var t=new n(this.width,this.height,this.indexedPixels,this.colorDepth);t.encode(this.out)},a.prototype.stream=function(){return this.out},e.exports=a},{"./LZWEncoder.js":2,"./TypedNeuQuant.js":3}],2:[function(t,e,i){var r=-1,n=12,o=5003,s=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];function a(t,e,i,a){var h,l,u,p,f,c,y=Math.max(2,a),d=new Uint8Array(256),w=new Int32Array(o),g=new Int32Array(o),b=0,x=0,v=!1;function P(t,e){d[l++]=t,l>=254&&M(e)}function m(t){B(o),x=f+2,v=!0,A(f,t)}function B(t){for(var e=0;e<t;++e)w[e]=-1}function S(t,e){var i,s,a,h,y,d,b;for(p=t,v=!1,n_bits=p,u=F(n_bits),f=1<<t-1,c=f+1,x=f+2,l=0,h=C(),b=0,i=o;i<65536;i*=2)++b;b=8-b,d=o,B(d),A(f,e);t:while((s=C())!=r)if(i=(s<<n)+h,a=s<<b^h,w[a]!==i){if(w[a]>=0){y=d-a,0===a&&(y=1);do{if((a-=y)<0&&(a+=d),w[a]===i){h=g[a];continue t}}while(w[a]>=0)}A(h,e),h=s,x<1<<n?(g[a]=x++,w[a]=i):m(e)}else h=g[a];A(h,e),A(c,e)}function T(i){i.writeByte(y),remaining=t*e,curPixel=0,S(y+1,i),i.writeByte(0)}function M(t){l>0&&(t.writeByte(l),t.writeBytes(d,0,l),l=0)}function F(t){return(1<<t)-1}function C(){if(0===remaining)return r;--remaining;var t=i[curPixel++];return 255&t}function A(t,e){h&=s[b],b>0?h|=t<<b:h=t,b+=n_bits;while(b>=8)P(255&h,e),h>>=8,b-=8;if((x>u||v)&&(v?(u=F(n_bits=p),v=!1):(++n_bits,u=n_bits==n?1<<n:F(n_bits))),t==c){while(b>0)P(255&h,e),h>>=8,b-=8;M(e)}}this.encode=T}e.exports=a},{}],3:[function(t,e,i){var r=100,n=256,o=n-1,s=4,a=16,h=1<<a,l=10,u=10,p=h>>u,f=h<<l-u,c=n>>3,y=6,d=1<<y,w=c*d,g=30,b=10,x=1<<b,v=8,P=1<<v,m=b+v,B=1<<m,S=499,T=491,M=487,F=503,C=3*F;function A(t,e){var i,c,d,b,v;function m(){var t,e;for(i=[],c=new Int32Array(256),d=new Int32Array(n),b=new Int32Array(n),v=new Int32Array(n>>3),t=0;t<n;t++)e=(t<<s+8)/n,i[t]=new Float64Array([e,e,e,0]),b[t]=h/n,d[t]=0}function A(){for(var t=0;t<n;t++)i[t][0]>>=s,i[t][1]>>=s,i[t][2]>>=s,i[t][3]=t}function E(t,e,r,n,o){i[e][0]-=t*(i[e][0]-r)/x,i[e][1]-=t*(i[e][1]-n)/x,i[e][2]-=t*(i[e][2]-o)/x}function I(t,e,r,o,s){var a,h,l=Math.abs(e-t),u=Math.min(e+t,n),p=e+1,f=e-1,c=1;while(p<u||f>l)h=v[c++],p<u&&(a=i[p++],a[0]-=h*(a[0]-r)/B,a[1]-=h*(a[1]-o)/B,a[2]-=h*(a[2]-s)/B),f>l&&(a=i[f--],a[0]-=h*(a[0]-r)/B,a[1]-=h*(a[1]-o)/B,a[2]-=h*(a[2]-s)/B)}function D(t,e,r){var o,h,c,y,w,g=~(1<<31),x=g,v=-1,P=v;for(o=0;o<n;o++)h=i[o],c=Math.abs(h[0]-t)+Math.abs(h[1]-e)+Math.abs(h[2]-r),c<g&&(g=c,v=o),y=c-(d[o]>>a-s),y<x&&(x=y,P=o),w=b[o]>>u,b[o]-=w,d[o]+=w<<l;return b[v]+=p,d[v]-=f,P}function G(){var t,e,r,s,a,h,l=0,u=0;for(t=0;t<n;t++){for(r=i[t],a=t,h=r[1],e=t+1;e<n;e++)s=i[e],s[1]<h&&(a=e,h=s[1]);if(s=i[a],t!=a&&(e=s[0],s[0]=r[0],r[0]=e,e=s[1],s[1]=r[1],r[1]=e,e=s[2],s[2]=r[2],r[2]=e,e=s[3],s[3]=r[3],r[3]=e),h!=l){for(c[l]=u+t>>1,e=l+1;e<h;e++)c[e]=t;l=h,u=t}}for(c[l]=u+o>>1,e=l+1;e<256;e++)c[e]=o}function _(t,e,r){var o,s,a,h=1e3,l=-1,u=c[e],p=u-1;while(u<n||p>=0)u<n&&(s=i[u],a=s[1]-e,a>=h?u=n:(u++,a<0&&(a=-a),o=s[0]-t,o<0&&(o=-o),a+=o,a<h&&(o=s[2]-r,o<0&&(o=-o),a+=o,a<h&&(h=a,l=s[3])))),p>=0&&(s=i[p],a=e-s[1],a>=h?p=-1:(p--,a<0&&(a=-a),o=s[0]-t,o<0&&(o=-o),a+=o,a<h&&(o=s[2]-r,o<0&&(o=-o),a+=o,a<h&&(h=a,l=s[3]))));return l}function j(){var i,n,o,a,h,l,u=t.length,p=30+(e-1)/3,f=u/(3*e),c=~~(f/r),d=x,b=w,m=b>>y;for(m<=1&&(m=0),i=0;i<m;i++)v[i]=d*((m*m-i*i)*P/(m*m));u<C?(e=1,n=3):n=u%S!==0?3*S:u%T!==0?3*T:u%M!==0?3*M:3*F;var B=0;i=0;while(i<f)if(o=(255&t[B])<<s,a=(255&t[B+1])<<s,h=(255&t[B+2])<<s,l=D(o,a,h),E(d,l,o,a,h),0!==m&&I(m,l,o,a,h),B+=n,B>=u&&(B-=u),i++,0===c&&(c=1),i%c===0)for(d-=d/p,b-=b/g,m=b>>y,m<=1&&(m=0),l=0;l<m;l++)v[l]=d*((m*m-l*l)*P/(m*m))}function z(){m(),j(),A(),G()}function U(){for(var t=[],e=[],r=0;r<n;r++)e[i[r][3]]=r;for(var o=0,s=0;s<n;s++){var a=e[s];t[o++]=i[a][0],t[o++]=i[a][1],t[o++]=i[a][2]}return t}this.buildColormap=z,this.getColormap=U,this.lookupRGB=_}e.exports=A},{}],4:[function(t,e,i){var r,n;r=t("./GIFEncoder.js"),n=function(t){var e,i,n,o;return e=new r(t.width,t.height),0===t.index?e.writeHeader():e.firstFrame=!1,e.setTransparent(t.transparent),e.setRepeat(t.repeat),e.setDelay(t.delay),e.setQuality(t.quality),e.setDither(t.dither),e.setGlobalPalette(t.globalPalette),e.addFrame(t.data),t.last&&e.finish(),!0===t.globalPalette&&(t.globalPalette=e.getGlobalPalette()),n=e.stream(),t.data=n.pages,t.cursor=n.cursor,t.pageSize=n.constructor.pageSize,t.canTransfer?(o=function(){var e,r,n,o;for(n=t.data,o=[],e=0,r=n.length;e<r;e++)i=n[e],o.push(i.buffer);return o}(),self.postMessage(t,o)):self.postMessage(t)},self.onmessage=function(t){return n(t.data)}},{"./GIFEncoder.js":1}]},{},[4])}});',"Worker",void 0,r.p+"js/gif.worker.ca349407.worker.js")}}}]);