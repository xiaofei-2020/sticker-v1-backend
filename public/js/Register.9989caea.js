(this["webpackJsonp"]=this["webpackJsonp"]||[]).push([["Register"],{"73cf":function(e,r,t){"use strict";t.r(r);var s=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"page-register"},[e._m(0),t("section",[t("el-form",{key:"register",ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.RegisterForm,rules:e.rules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[t("el-input",{model:{value:e.RegisterForm.email,callback:function(r){e.$set(e.RegisterForm,"email",r)},expression:"RegisterForm.email"}}),t("el-button",{attrs:{size:"mini"},on:{click:e.sendMsg}},[e._v("发送验证码")]),t("span",{staticClass:"status"},[e._v(e._s(e.statusMsg))])],1),t("el-form-item",{attrs:{label:"验证码",prop:"code"}},[t("el-input",{model:{value:e.RegisterForm.verify_code,callback:function(r){e.$set(e.RegisterForm,"verify_code",r)},expression:"RegisterForm.verify_code"}})],1),t("el-form-item",{attrs:{label:"密码",prop:"psd"}},[t("el-input",{attrs:{type:"password"},model:{value:e.RegisterForm.psd,callback:function(r){e.$set(e.RegisterForm,"psd",r)},expression:"RegisterForm.psd"}})],1),t("el-form-item",{attrs:{label:"确认密码",prop:"cpsd"}},[t("el-input",{attrs:{type:"password"},model:{value:e.RegisterForm.cpsd,callback:function(r){e.$set(e.RegisterForm,"cpsd",r)},expression:"RegisterForm.cpsd"}})],1),t("el-form-item",{staticClass:"register-btn"},[t("el-button",{attrs:{type:"primary"},on:{click:e.register}},[e._v(" 注册 ")]),t("div",{staticClass:"error"},[e._v(e._s(e.error))])],1),t("el-form-item",{staticClass:"margin-r"},[t("a",{staticClass:"f1",attrs:{target:"_blank"},on:{click:function(r){return e.$router.back()}}},[t("i",{staticClass:"el-icon-back"}),e._v(" 返回")])])],1)],1)])},i=[function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("h2",[t("i",{staticClass:"el-icon-edit-outline"}),e._v(" 注 册")])}],a=t("1da1"),o=(t("96cf"),t("9816")),n={name:"Register",layout:"blank",data:function(){var e=this;return{statusMsg:"",error:"",verify_Code:{type:"REGIST",account_email:""},account:{email:"",psd:""},RegisterForm:{verify_code:"",psd:"",cpsd:"",email:""},rules:{email:[{required:!0,type:"email",message:"请输入邮箱",trigger:"blur"}],psd:[{required:!0,message:"请输入密码",trigger:"blur"}],cpsd:[{required:!0,message:"确认密码有误，请重新输入",trigger:"blur"},{validator:function(r,t,s){""===t?s(new Error("请再次输入密码")):t!==e.RegisterForm.psd?s(new Error("两次输入密码不一致")):s()},trigger:"blur"}]}}},methods:{sendMsg:function(){var e=this,r=this;this.$refs.ruleForm.validateField("email",Object(a["a"])(regeneratorRuntime.mark((function t(){var s,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.post("/verify_code",{type:"REGIST",account_email:r.RegisterForm.email});case 2:if(s=t.sent,i=s.data,i.success){t.next=6;break}return t.abrupt("return",e.$message.error("登录失败 帐号或密码错误!"));case 6:e.$message.success(i.msg);case 7:case"end":return t.stop()}}),t)}))))},register:function(){var e=this,r=new o["a"],t=this;this.$refs.ruleForm.validate(function(){var s=Object(a["a"])(regeneratorRuntime.mark((function s(i){var a,o,n;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(!i){s.next=15;break}return r.setPublicKey("-----BEGIN PUBLIC KEY-----\nMFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBALC6d1bI8gnTcsvBwAu7oVAPfWKM8fYQ\n+Q36jkJdcD8AR3BRf+ZwOMlU7rdm0otQRfgsqJjfg3RwHGfAObPxoXsCAwEAAQ==\n-----END PUBLIC KEY-----"),a=r.encrypt(t.RegisterForm.psd),s.next=5,e.$http.post("/account",{psd:a,email:e.RegisterForm.email,verify_code:e.RegisterForm.verify_code});case 5:if(o=s.sent,n=o.data,n.success){s.next=10;break}return e.loginLoading=!1,s.abrupt("return",e.$message.error("注册失败!"+n.message));case 10:e.$message.success(n.msg),e.$root.updateUserInfo({email:e.RegisterForm.email,token:n.data}),sessionStorage.setItem("email",e.RegisterForm.email),window.sessionStorage.setItem("token",n.data),e.$router.push("/");case 15:case"end":return s.stop()}}),s)})));return function(e){return s.apply(this,arguments)}}())}}},c=n,l=(t("9bf25"),t("2877")),u=Object(l["a"])(c,s,i,!1,null,"4ca857bb",null);r["default"]=u.exports},"9bf25":function(e,r,t){"use strict";t("cd3f")},cd3f:function(e,r,t){}}]);